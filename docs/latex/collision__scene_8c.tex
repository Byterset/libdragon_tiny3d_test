\hypertarget{collision__scene_8c}{}\doxysection{src/collision/collision\+\_\+scene.c File Reference}
\label{collision__scene_8c}\index{src/collision/collision\_scene.c@{src/collision/collision\_scene.c}}
{\ttfamily \#include \char`\"{}collision\+\_\+scene.\+h\char`\"{}}\newline
{\ttfamily \#include $<$malloc.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$libdragon.\+h$>$}\newline
{\ttfamily \#include \char`\"{}mesh\+\_\+collider.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}collide.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}collide\+\_\+swept.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}contact.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../util/hash\+\_\+map.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../render/defs.\+h\char`\"{}}\newline
{\ttfamily \#include $<$raylib.\+h$>$}\newline
{\ttfamily \#include $<$rlgl.\+h$>$}\newline
{\ttfamily \#include $<$raymath.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../game/gamestate.\+h\char`\"{}}\newline
Include dependency graph for collision\+\_\+scene.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{collision__scene_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{collision__scene_8c_ae802ccf54b4d431358718926fb804387}{MAX\+\_\+\+SWEPT\+\_\+\+ITERATIONS}}~5
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{collision__scene_8c_ad775fb1f73ec2ae6a0dc2ca0d00e8ed2}{collision\+\_\+scene\+\_\+reset}} ()
\item 
struct \mbox{\hyperlink{structcollision__scene}{collision\+\_\+scene}} $\ast$ \mbox{\hyperlink{collision__scene_8c_a41b2de49293775e2611c115f043ca977}{collision\+\_\+scene\+\_\+get}} ()
\item 
void \mbox{\hyperlink{collision__scene_8c_a3fb9c52da6d5e024b3099511176af20f}{collision\+\_\+scene\+\_\+add}} (struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$object)
\item 
struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$ \mbox{\hyperlink{collision__scene_8c_a4f9efa8dbc05e1aaf5abe42dfd09b83d}{collision\+\_\+scene\+\_\+find\+\_\+object}} (\mbox{\hyperlink{entity__id_8h_a0b6e47c2160096e2e59d383c2c80dcd0}{entity\+\_\+id}} id)
\begin{DoxyCompactList}\small\item\em Returns the physics object associated with the given entity id if it exists in the collision scene. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{collision__scene_8c_a8d29913418bdec161329b9922254bfe0}{collision\+\_\+scene\+\_\+release\+\_\+object\+\_\+contacts}} (struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$object)
\begin{DoxyCompactList}\small\item\em Returns the active contacts of a physics object to the global scene\textquotesingle{}s free contact list. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{collision__scene_8c_a14466d75771dffa6469e76d638991527}{collision\+\_\+scene\+\_\+remove}} (struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$object)
\begin{DoxyCompactList}\small\item\em Removes a physics object from the collision scene. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{collision__scene_8c_a22135104ce37607b2369f69a7957a10d}{collision\+\_\+scene\+\_\+use\+\_\+static\+\_\+collision}} (struct \mbox{\hyperlink{structmesh__collider}{mesh\+\_\+collider}} $\ast$\mbox{\hyperlink{structmesh__collider}{mesh\+\_\+collider}})
\item 
void \mbox{\hyperlink{collision__scene_8c_a62d6ea639161d9864a203e79d8be7ba5}{collision\+\_\+scene\+\_\+remove\+\_\+static\+\_\+collision}} ()
\begin{DoxyCompactList}\small\item\em Removes the current static collision mesh from the scene. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{collision__scene_8c_a4faf12dfbc02b158ff614889c56ae057}{collision\+\_\+scene\+\_\+collide\+\_\+phys\+\_\+object}} (struct \mbox{\hyperlink{structcollision__scene__element}{collision\+\_\+scene\+\_\+element}} $\ast$element)
\begin{DoxyCompactList}\small\item\em Performs collision detection for a single physics object agains other objects in the scene. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{collision__scene_8c_aeff2970df7f71b24b99382cb2f30a679}{collision\+\_\+scene\+\_\+collide\+\_\+single}} (struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$object, struct \mbox{\hyperlink{structVector3}{Vector3}} $\ast$prev\+\_\+pos)
\item 
void \mbox{\hyperlink{collision__scene_8c_a3b3de1d5fd79c57e3bdb6846ce901c9a}{collision\+\_\+scene\+\_\+step}} ()
\begin{DoxyCompactList}\small\item\em performs a physics step on all objects in the scene, updating their positions and velocities and performing collision detection \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structcontact}{contact}} $\ast$ \mbox{\hyperlink{collision__scene_8c_aef93064a3e4c7692aac96c267f484831}{collision\+\_\+scene\+\_\+new\+\_\+contact}} ()
\begin{DoxyCompactList}\small\item\em Returns a new contact from the global scene\textquotesingle{}s free contact list, NULL if none are available. \end{DoxyCompactList}\item 
Raylib\+\_\+\+Vector3 $\ast$ \mbox{\hyperlink{collision__scene_8c_a6f5b82481e401273f3b9e9f953a4a5cc}{Mesh\+To\+Vertices}} (Raylib\+\_\+\+Mesh mesh)
\item 
void \mbox{\hyperlink{collision__scene_8c_a9b74c694f952802a237ef57dd9bf02f2}{collision\+\_\+scene\+\_\+render\+\_\+debug\+\_\+raylib}} ()
\begin{DoxyCompactList}\small\item\em Renders the collision scene colliders in debug mode using raylib. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structcollision__scene}{collision\+\_\+scene}} \mbox{\hyperlink{collision__scene_8c_ad32685dd50615a7f993a2a00b8e5a50d}{g\+\_\+scene}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{collision__scene_8c_ae802ccf54b4d431358718926fb804387}\label{collision__scene_8c_ae802ccf54b4d431358718926fb804387}} 
\index{collision\_scene.c@{collision\_scene.c}!MAX\_SWEPT\_ITERATIONS@{MAX\_SWEPT\_ITERATIONS}}
\index{MAX\_SWEPT\_ITERATIONS@{MAX\_SWEPT\_ITERATIONS}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{MAX\_SWEPT\_ITERATIONS}{MAX\_SWEPT\_ITERATIONS}}
{\footnotesize\ttfamily \#define MAX\+\_\+\+SWEPT\+\_\+\+ITERATIONS~5}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{collision__scene_8c_a3fb9c52da6d5e024b3099511176af20f}\label{collision__scene_8c_a3fb9c52da6d5e024b3099511176af20f}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_add@{collision\_scene\_add}}
\index{collision\_scene\_add@{collision\_scene\_add}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_add()}{collision\_scene\_add()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+add (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$}]{object }\end{DoxyParamCaption})}

\mbox{\Hypertarget{collision__scene_8c_a4faf12dfbc02b158ff614889c56ae057}\label{collision__scene_8c_a4faf12dfbc02b158ff614889c56ae057}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_collide\_phys\_object@{collision\_scene\_collide\_phys\_object}}
\index{collision\_scene\_collide\_phys\_object@{collision\_scene\_collide\_phys\_object}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_collide\_phys\_object()}{collision\_scene\_collide\_phys\_object()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+collide\+\_\+phys\+\_\+object (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structcollision__scene__element}{collision\+\_\+scene\+\_\+element}} $\ast$}]{element }\end{DoxyParamCaption})}



Performs collision detection for a single physics object agains other objects in the scene. 

First a broad phase detection using a \mbox{\hyperlink{structAABB}{AABB}} BVH tree is performed to find potential collision candidates. Then a narrow phase detection (GJK/\+EPA) is performed to check for and resolve actual collisions. 
\begin{DoxyParams}{Parameters}
{\em element} & the scene element (phys object) to check for collisions \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{collision__scene_8c_aeff2970df7f71b24b99382cb2f30a679}\label{collision__scene_8c_aeff2970df7f71b24b99382cb2f30a679}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_collide\_single@{collision\_scene\_collide\_single}}
\index{collision\_scene\_collide\_single@{collision\_scene\_collide\_single}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_collide\_single()}{collision\_scene\_collide\_single()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+collide\+\_\+single (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$}]{object,  }\item[{struct \mbox{\hyperlink{structVector3}{Vector3}} $\ast$}]{prev\+\_\+pos }\end{DoxyParamCaption})}

\mbox{\Hypertarget{collision__scene_8c_a4f9efa8dbc05e1aaf5abe42dfd09b83d}\label{collision__scene_8c_a4f9efa8dbc05e1aaf5abe42dfd09b83d}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_find\_object@{collision\_scene\_find\_object}}
\index{collision\_scene\_find\_object@{collision\_scene\_find\_object}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_find\_object()}{collision\_scene\_find\_object()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}}$\ast$ collision\+\_\+scene\+\_\+find\+\_\+object (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{entity__id_8h_a0b6e47c2160096e2e59d383c2c80dcd0}{entity\+\_\+id}}}]{id }\end{DoxyParamCaption})}



Returns the physics object associated with the given entity id if it exists in the collision scene. 

\mbox{\Hypertarget{collision__scene_8c_a41b2de49293775e2611c115f043ca977}\label{collision__scene_8c_a41b2de49293775e2611c115f043ca977}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_get@{collision\_scene\_get}}
\index{collision\_scene\_get@{collision\_scene\_get}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_get()}{collision\_scene\_get()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structcollision__scene}{collision\+\_\+scene}}$\ast$ collision\+\_\+scene\+\_\+get (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{collision__scene_8c_aef93064a3e4c7692aac96c267f484831}\label{collision__scene_8c_aef93064a3e4c7692aac96c267f484831}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_new\_contact@{collision\_scene\_new\_contact}}
\index{collision\_scene\_new\_contact@{collision\_scene\_new\_contact}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_new\_contact()}{collision\_scene\_new\_contact()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structcontact}{contact}}$\ast$ collision\+\_\+scene\+\_\+new\+\_\+contact (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns a new contact from the global scene\textquotesingle{}s free contact list, NULL if none are available. 

\mbox{\Hypertarget{collision__scene_8c_a8d29913418bdec161329b9922254bfe0}\label{collision__scene_8c_a8d29913418bdec161329b9922254bfe0}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_release\_object\_contacts@{collision\_scene\_release\_object\_contacts}}
\index{collision\_scene\_release\_object\_contacts@{collision\_scene\_release\_object\_contacts}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_release\_object\_contacts()}{collision\_scene\_release\_object\_contacts()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+release\+\_\+object\+\_\+contacts (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$}]{object }\end{DoxyParamCaption})}



Returns the active contacts of a physics object to the global scene\textquotesingle{}s free contact list. 

This function iterates through the active contacts of the given physics object and appends them to the global scene\textquotesingle{}s free contact list. It ensures that the active contacts of the object are properly returned and the object\textquotesingle{}s active contact list is cleared.


\begin{DoxyParams}{Parameters}
{\em object} & Pointer to the physics object whose active contacts are to be returned. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{collision__scene_8c_a14466d75771dffa6469e76d638991527}\label{collision__scene_8c_a14466d75771dffa6469e76d638991527}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_remove@{collision\_scene\_remove}}
\index{collision\_scene\_remove@{collision\_scene\_remove}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_remove()}{collision\_scene\_remove()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+remove (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structphysics__object}{physics\+\_\+object}} $\ast$}]{object }\end{DoxyParamCaption})}



Removes a physics object from the collision scene. 

The removed object will no longer be updated in the phys loop or considered for collision. All contacts associated with the object will be released. 
\begin{DoxyParams}{Parameters}
{\em object} & ~\newline
 \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{collision__scene_8c_a62d6ea639161d9864a203e79d8be7ba5}\label{collision__scene_8c_a62d6ea639161d9864a203e79d8be7ba5}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_remove\_static\_collision@{collision\_scene\_remove\_static\_collision}}
\index{collision\_scene\_remove\_static\_collision@{collision\_scene\_remove\_static\_collision}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_remove\_static\_collision()}{collision\_scene\_remove\_static\_collision()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+remove\+\_\+static\+\_\+collision (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Removes the current static collision mesh from the scene. 

\mbox{\Hypertarget{collision__scene_8c_a9b74c694f952802a237ef57dd9bf02f2}\label{collision__scene_8c_a9b74c694f952802a237ef57dd9bf02f2}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_render\_debug\_raylib@{collision\_scene\_render\_debug\_raylib}}
\index{collision\_scene\_render\_debug\_raylib@{collision\_scene\_render\_debug\_raylib}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_render\_debug\_raylib()}{collision\_scene\_render\_debug\_raylib()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+render\+\_\+debug\+\_\+raylib (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Renders the collision scene colliders in debug mode using raylib. 

\mbox{\Hypertarget{collision__scene_8c_ad775fb1f73ec2ae6a0dc2ca0d00e8ed2}\label{collision__scene_8c_ad775fb1f73ec2ae6a0dc2ca0d00e8ed2}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_reset@{collision\_scene\_reset}}
\index{collision\_scene\_reset@{collision\_scene\_reset}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_reset()}{collision\_scene\_reset()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+reset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{collision__scene_8c_a3b3de1d5fd79c57e3bdb6846ce901c9a}\label{collision__scene_8c_a3b3de1d5fd79c57e3bdb6846ce901c9a}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_step@{collision\_scene\_step}}
\index{collision\_scene\_step@{collision\_scene\_step}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_step()}{collision\_scene\_step()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+step (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



performs a physics step on all objects in the scene, updating their positions and velocities and performing collision detection 

\mbox{\Hypertarget{collision__scene_8c_a22135104ce37607b2369f69a7957a10d}\label{collision__scene_8c_a22135104ce37607b2369f69a7957a10d}} 
\index{collision\_scene.c@{collision\_scene.c}!collision\_scene\_use\_static\_collision@{collision\_scene\_use\_static\_collision}}
\index{collision\_scene\_use\_static\_collision@{collision\_scene\_use\_static\_collision}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{collision\_scene\_use\_static\_collision()}{collision\_scene\_use\_static\_collision()}}
{\footnotesize\ttfamily void collision\+\_\+scene\+\_\+use\+\_\+static\+\_\+collision (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structmesh__collider}{mesh\+\_\+collider}} $\ast$}]{mesh\+\_\+collider }\end{DoxyParamCaption})}

\mbox{\Hypertarget{collision__scene_8c_a6f5b82481e401273f3b9e9f953a4a5cc}\label{collision__scene_8c_a6f5b82481e401273f3b9e9f953a4a5cc}} 
\index{collision\_scene.c@{collision\_scene.c}!MeshToVertices@{MeshToVertices}}
\index{MeshToVertices@{MeshToVertices}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{MeshToVertices()}{MeshToVertices()}}
{\footnotesize\ttfamily Raylib\+\_\+\+Vector3$\ast$ Mesh\+To\+Vertices (\begin{DoxyParamCaption}\item[{Raylib\+\_\+\+Mesh}]{mesh }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{collision__scene_8c_ad32685dd50615a7f993a2a00b8e5a50d}\label{collision__scene_8c_ad32685dd50615a7f993a2a00b8e5a50d}} 
\index{collision\_scene.c@{collision\_scene.c}!g\_scene@{g\_scene}}
\index{g\_scene@{g\_scene}!collision\_scene.c@{collision\_scene.c}}
\doxysubsubsection{\texorpdfstring{g\_scene}{g\_scene}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structcollision__scene}{collision\+\_\+scene}} g\+\_\+scene}

